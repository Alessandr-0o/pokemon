from xgboost import XGBClassifier
from sklearn.model_selection import GridSearchCV, StratifiedKFold

from sklearn.model_selection import GridSearchCV, StratifiedKFold
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression

cv = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)

lr_pipe = Pipeline([
    ('scaler', StandardScaler()),
    ('logreg', LogisticRegression(
        max_iter=1000,
        solver='liblinear',  
        random_state=42
    ))
])


param_grid_lr = {
    'logreg__C': [0.05, 0.1, 0.15, 0.25, 0.4, 0.6, 0.8, 1.0, 1.2, 1.5],
    'logreg__penalty': ['l1', 'l2']
}


grid_lr = GridSearchCV(
    estimator=lr_pipe,
    param_grid=param_grid_lr,
    scoring='accuracy',
    cv=cv,
    n_jobs=-1,
    verbose=1
)


grid = grid_lr.fit(X_train, y_train)

print("Best params:", grid.best_params_)
print("Best CV score:", grid.best_score_)

best_lr = grid.best_estimator_


y_test_pred = best_lr.predict(X_test)


submission = pd.DataFrame({
    'battle_id': test_df['battle_id'],
    'player_won': y_test_pred
})
submission.to_csv('submission.csv', index=False)
print("Salvata: submission.csv")
